data=[
    4.0,7.5,10,0.075,0.75;
6.0,14.0,10,0.14,1.4;
8.0,15.5,20,0.31,3.1;
8.5,8.0,50,0.4,4.0;
9.0,11.0,50,0.55,5.5;
9.2,13.0,50,0.65,6.5;
9.4,15.5,50,0.775,7.75;
9.6,19.0,50,0.95,9.5;
9.8,11.5,100,1.15,11.5;
10.0,13.5,100,1.35,13.5;
10.3,15.5,100,1.55,15.5;
10.4,15.0,100,1.5,15.0;
10.6,13.5,100,1.35,13.5;
10.8,11.5,100,1.15,11.5;
11.0,8.5,100,0.85,8.5;
11.5,13.0,50,0.65,6.5;
12.0,10.0,50,0.5,5.0;
14.0,5.0,50,0.25,2.5;
16.0,3.5,50,0.175,1.75;
18.0,6.5,20,0.13,1.3;
20.0,11.0,10,0.11,1.1]  ; 

x       = data(:,1) ; 
voltage = data(:,4) ;
y       = data(:,5) ;

plot(x,y,'o')

%% -------------------------------------------------
tol = 0.001
R        = 100 
C        = 4.7*10^(-9);
L        = 100*10^(-6)
f        = @(x,L)  (C*x)./sqrt((C*L*x.^2-1).^2+C^2*R^2*x.^2)
fprime   = @(x,L) -(C^2*x.^3.*(C*L*x.^2-1))./((C*L*x.^2-1).^2+C^2*R^2*x.^2).^(3/2)
iter_max = 50 ; 
n        = length(x);

J = [fprime(x,L)];
d = y-[f(x,L)] ;

for iter = 1:iter_max 
    L0 = L;
%     for i = 1:n 
%         f        = @(x,L)  (C*x)./sqrt((C*L*x.^2-1).^2+C^2*R^2*x.^2)
%         fprime   = @(x,L) -(C^2*x.^3.*(C*L*x.^2-1))./((C*L*x.^2-1).^2+C^2*R^2*x.^2).^(3/2)
%     end
    J  = [fprime(x,L)] ;
    d  = y-[f(x,L)]    ;
    dL = (J'*d)/(J'*J) ;
    L  = L + dL'        ; 
    if abs(dL) < tol  
       disp('Gauss-neqto has converged')
       break
    end
end




