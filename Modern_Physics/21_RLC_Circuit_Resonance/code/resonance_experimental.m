% data=[
%     4.0,7.5,10,0.075,0.75;
% 6.0,14.0,10,0.14,1.4;
% 8.0,15.5,20,0.31,3.1;
% 8.5,8.0,50,0.4,4.0;
% 9.0,11.0,50,0.55,5.5;
% 9.2,13.0,50,0.65,6.5;
% 9.4,15.5,50,0.775,7.75;
% 9.6,19.0,50,0.95,9.5;
% 9.8,11.5,100,1.15,11.5;
% 10.0,13.5,100,1.35,13.5;
% 10.3,15.5,100,1.55,15.5;
% 10.4,15.0,100,1.5,15.0;
% 10.6,13.5,100,1.35,13.5;
% 10.8,11.5,100,1.15,11.5;
% 11.0,8.5,100,0.85,8.5;
% 11.5,13.0,50,0.65,6.5;
% 12.0,10.0,50,0.5,5.0;
% 14.0,5.0,50,0.25,2.5;
% 16.0,3.5,50,0.175,1.75;
% 18.0,6.5,20,0.13,1.3;
% 20.0,11.0,10,0.11,1.1]  ; 
data = [4.0,7.5,10,0.015,0.15;
6.0,14.0,10,0.028,0.28;
8.0,15.5,20,0.062,0.62;
8.5,8.0,50,0.08,0.8;
9.0,11.0,50,0.11,1.1;
9.2,13.0,50,0.13,1.3;
9.4,15.5,50,0.155,1.55;
9.6,19.0,50,0.19,1.9;
9.8,11.5,100,0.23,2.3;
10.0,13.5,100,0.27,2.7;
10.3,15.5,100,0.31,3.1;
10.4,15.0,100,0.3,3.0;
10.6,13.5,100,0.27,2.7;
10.8,11.5,100,0.23,2.3;
11.0,8.5,100,0.17,1.7;
11.5,13.0,50,0.13,1.3;
12.0,10.0,50,0.1,1.0;
14.0,5.0,50,0.05,0.5;
16.0,3.5,50,0.035,0.35;
18.0,6.5,20,0.026,0.26;
20.0,11.0,10,0.022,0.22];

f       = data(:,1) ; 
voltage = data(:,4) ;
i0      = data(:,5) ;
V0=1;
C       = 4.7*10^(-9);
R       = 100; 
L       = 0.051;
n       = 5;

% %[a b c d ] = regPol(n,f,i0,'-black','f_0(kHz)','I_0 (mA)') ;
% plot(f,i0,'*')  
% hold on 
% ff = 4:0.01:20; 
% % ii = V0*C*2*pi*ff./sqrt(R^2*C^2*4*pi^2*ff.^2 + (L*4*pi^2*ff.^2*C-1).^2);
% %ii  = V0./sqrt(R^2+(L*ff*2*pi-1./(C*ff*2*pi) ).^2)  ;
% plot(ff,ii)


%plot(f,i0,'*') 
%hold on 
%grid on 
%% 1st half 
f1  = f(1:13)  ;
i01 = i0(1:13) ;  
%[a1 b1 c1 d1 ] = regPol(n,f1,i01,'-black','f_0(kHz)','I_0 (mA)') ; 
%smooth_spline_fit_Ir(f1, i01, '1.5')
%% 2nd half
f2  = f(11:21);
i02 = i0(11:21); 
%[a2 b2 c2 d2 ] = regPol(n,f2,i02,'-black','f_0(kHz)','I_0(mA)') ; 
%smooth_spline_fit_Ir(f2,i02,'1.5')

%% phase difference
dat = [ 4.0,3.0,100.0,300.0,43.20
6.0,2.0,100.0,200.0,43.20
8.0,3.0,50.0,150.0,43.20
8.5,2.5,50.0,125.0,38.25
9.0,2.0,50.0,100.0,32.40
9.5,4.0,20.0,80.0,27.36
10.0,3.0,20.0,60.0,21.60
10.5,-4.0,10.0,-40.0,-15.12
11.0,-3.5,20.0,-70.0,-27.72
11.5,-4.0,20.0,-80.0,-33.12
12.0,-4.0,20.0,-80.0,-34.56
14.0,-4.0,20.0,-80.0,-40.32
16.0,-4.0,20.0,-80.0,-46.08
18.0,-3.0,20.0,-60.0,-38.88
20.0,-3.0,20.0,-60.0,-43.2] ; 

% phi=dat(:,5) ; 
% f  =dat(:,1);
% figure(2)
% plot(f,phi)
% [a b c d ] = regPol(3,f,phi,'-black','f_0(kHz)','I_0 (mA)') ; 
